{"ast":null,"code":"import{useParams}from\"react-router-dom\";import{useState,useRef,useEffect}from\"react\";// Add useRef and useEffect\nimport PrivateRoute from'../../CodeLoginAuth/components/PrivateRoute';import{createComment}from\"../services/commentsAPI\";import'../nonGlobalStyle/CreateComment.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CreateComment=_ref=>{let{onCommentCreated}=_ref;const{id}=useParams();const[content,setContent]=useState('');const[proStatus,setProStatus]=useState(null);const[isSubmitting,setIsSubmitting]=useState(false);const[error,setError]=useState('');// Add mount tracking ref\nconst isMounted=useRef(true);useEffect(()=>{return()=>{isMounted.current=false;};},[]);const handleSubmit=async e=>{e.preventDefault();if(proStatus===null){setError('Please specify if this comment proves or disproves the root node');return;}setIsSubmitting(true);setError('');// Add request timeout (10 seconds)\nlet timeoutId=setTimeout(()=>{if(isMounted.current){setError('Request timed out. Try refreshing the page.');setIsSubmitting(false);}},10000);try{console.log(content);const createdComment=await createComment(id,content,proStatus);clearTimeout(timeoutId);// Clear timeout on success\nif(!isMounted.current)return;// Check mount before state updates\nif(onCommentCreated){onCommentCreated(createdComment);// Pass object directly\n}setContent('');setProStatus(null);}catch(error){clearTimeout(timeoutId);// Clear timeout on error\nif(isMounted.current){setError(error.message||'Failed to create comment');}}finally{clearTimeout(timeoutId);// Ensure timeout is always cleared\nif(isMounted.current){setIsSubmitting(false);}}};return/*#__PURE__*/_jsx(PrivateRoute,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"topic-form\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-3\",children:\"Create New Comment\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mb-3\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"radio-input\",children:\"Comment\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",value:content,onChange:e=>setContent(e.target.value),placeholder:\"Enter your comment\",required:true,disabled:isSubmitting,rows:4})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"radio-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"radio-option\",children:\"Does this comment prove or disprove the root node?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"radio-group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-check form-check-inline\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"radio-input\",type:\"radio\",name:\"proStatus\",id:\"proves\",value:\"true\",checked:proStatus===true,onChange:()=>setProStatus(true),required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"proves\",children:\"Proves\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"radio-group\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"radio-input\",type:\"radio\",name:\"proStatus\",id:\"disproves\",value:\"false\",checked:proStatus===false,onChange:()=>setProStatus(false)}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"disproves\",children:\"Disproves\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end gap-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:isSubmitting,children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",\"aria-hidden\":\"true\"}),\"Submitting...\"]}):'Submit Comment'})})]})]})});};export default CreateComment;","map":{"version":3,"names":["useParams","useState","useRef","useEffect","PrivateRoute","createComment","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CreateComment","_ref","onCommentCreated","id","content","setContent","proStatus","setProStatus","isSubmitting","setIsSubmitting","error","setError","isMounted","current","handleSubmit","e","preventDefault","timeoutId","setTimeout","console","log","createdComment","clearTimeout","message","children","className","onSubmit","value","onChange","target","placeholder","required","disabled","rows","type","name","checked","htmlFor"],"sources":["/Users/yc/Documents/MainWebsiteTree/ActualWebsite/Algorithm+TopicSutff/src/algorithm-app/src/CodeNode/components/CreateComment.js"],"sourcesContent":["import { useParams } from \"react-router-dom\";\nimport { useState, useRef, useEffect } from \"react\"; // Add useRef and useEffect\nimport PrivateRoute from '../../CodeLoginAuth/components/PrivateRoute';\nimport { createComment } from \"../services/commentsAPI\";\nimport '../nonGlobalStyle/CreateComment.css'\n\nconst CreateComment = ({ onCommentCreated }) => {\n  const { id } = useParams();\n  const [content, setContent] = useState('');\n  const [proStatus, setProStatus] = useState(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState('');\n  \n  // Add mount tracking ref\n  const isMounted = useRef(true);\n  useEffect(() => {\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (proStatus === null) {\n      setError('Please specify if this comment proves or disproves the root node');\n      return;\n    }\n\n    setIsSubmitting(true);\n    setError('');\n    \n    // Add request timeout (10 seconds)\n    let timeoutId = setTimeout(() => {\n      if (isMounted.current) {\n        setError('Request timed out. Try refreshing the page.');\n        setIsSubmitting(false);\n      }\n    }, 10000);\n\n    try {\n      console.log(content);\n      const createdComment = await createComment(id, content, proStatus);\n      clearTimeout(timeoutId); // Clear timeout on success\n      \n      if (!isMounted.current) return; // Check mount before state updates\n      \n     if (onCommentCreated) {\n        onCommentCreated(createdComment); // Pass object directly\n      }\n      setContent('');\n      setProStatus(null);\n    } catch (error) {\n      clearTimeout(timeoutId); // Clear timeout on error\n      if (isMounted.current) {\n        setError(error.message || 'Failed to create comment');\n      }\n    } finally {\n      clearTimeout(timeoutId); // Ensure timeout is always cleared\n      if (isMounted.current) {\n        setIsSubmitting(false);\n      }\n    }\n  };\n\n  return (\n    <PrivateRoute>\n      <div className=\"topic-form\">\n        <h2 className=\"mb-3\">Create New Comment</h2>\n        \n        {error && (\n          <div className=\"alert alert-danger mb-3\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"mb-3\">\n            <label className=\"radio-input\">Comment</label>\n            <textarea\n              className=\"form-control\"\n              value={content}\n              onChange={(e) => setContent(e.target.value)}\n              placeholder=\"Enter your comment\"\n              required\n              disabled={isSubmitting}\n              rows={4}\n            />\n          </div>\n          \n          {/* NEW: Radio buttons for proStatus */}\n          <div className=\"radio-group\">\n            <label className=\"radio-option\">\n              Does this comment prove or disprove the root node?\n            </label>\n            <div className=\"radio-group\">\n              <div className=\"form-check form-check-inline\">\n                <input\n                  className=\"radio-input\"\n                  type=\"radio\"\n                  name=\"proStatus\"\n                  id=\"proves\"\n                  value=\"true\"\n                  checked={proStatus === true}\n                  onChange={() => setProStatus(true)}\n                  required\n                />\n                <label className=\"form-check-label\" htmlFor=\"proves\">\n                  Proves\n                </label>\n              </div>\n              <div className=\"radio-group\">\n                <input\n                  className=\"radio-input\"\n                  type=\"radio\"\n                  name=\"proStatus\"\n                  id=\"disproves\"\n                  value=\"false\"\n                  checked={proStatus === false}\n                  onChange={() => setProStatus(false)}\n                />\n                <label className=\"form-check-label\" htmlFor=\"disproves\">\n                  Disproves\n                </label>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"d-flex justify-content-end gap-2\">\n            <button\n              type=\"submit\"\n              className=\"btn btn-primary\"\n              disabled={isSubmitting}\n            >\n              {isSubmitting ? (\n                <>\n                  <span className=\"spinner-border spinner-border-sm me-2\" aria-hidden=\"true\"></span>\n                  Submitting...\n                </>\n              ) : 'Submit Comment'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </PrivateRoute>\n  );\n};\n\nexport default CreateComment;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}