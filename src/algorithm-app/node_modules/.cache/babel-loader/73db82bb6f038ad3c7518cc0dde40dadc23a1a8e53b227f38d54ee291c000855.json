{"ast":null,"code":"var _jsxFileName = \"/Users/yc/Documents/MainWebsiteTree/Algorithm+TopicSutff/algorithm-app/src/components/NodePageComponents/CommentsSection.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport CreateComment from './CreateComment';\nimport getTimeDisplay from '../../utils/helperFunctions/GetTimeSince';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CommentsSection = ({\n  nodeId\n}) => {\n  _s();\n  const [comments, setComments] = React.useState([]);\n  const [showCommentForm, setShowCommentForm] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(true);\n\n  // Fetch comments\n  React.useEffect(() => {\n    const fetchComments = async () => {\n      setIsLoading(true);\n      try {\n        const commentRes = await fetch(`http://localhost:5000/api/nodes/${nodeId}/comments`);\n        const commentsData = await commentRes.json();\n        setComments(commentsData);\n      } catch (error) {\n        console.error('Error fetching comments:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchComments();\n  }, [nodeId]);\n  const refreshComments = newComment => {\n    if (!newComment) return; // Guard against undefined\n\n    // Optimistically update UI\n    setComments(prevComments => [newComment, ...prevComments]);\n    setShowCommentForm(false);\n\n    // Refetch to ensure data consistency\n    fetch(`http://localhost:5000/api/nodes/${nodeId}/comments`).then(res => res.json()).then(updatedComments => setComments(updatedComments)).catch(error => {\n      console.error('Refresh error:', error);\n      // Revert optimistic update on error\n      setComments(prev => prev.filter(c => c.id !== newComment.id));\n    });\n  };\n  if (isLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d-flex justify-content-center my-5\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"spinner-border\",\n      role: \"status\",\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"visually-hidden\",\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card mb-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card-header bg-light d-flex justify-content-between align-items-center py-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"h5 mb-0\",\n        children: \"Attempts to solve\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `btn btn-sm ${showCommentForm ? 'btn-outline-secondary' : 'btn-primary'}`,\n        onClick: () => setShowCommentForm(!showCommentForm),\n        children: showCommentForm ? 'Cancel' : 'Add New'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), showCommentForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card-body border-bottom\",\n      children: /*#__PURE__*/_jsxDEV(CreateComment, {\n        onCommentCreated: refreshComments\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"list-group list-group-flush\",\n      children: comments.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-muted\",\n          children: \"No comments yet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-link\",\n          onClick: () => setShowCommentForm(true),\n          children: \"Be the first to add a comment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this) : comments.map(comment => comment &&\n      /*#__PURE__*/\n      // Safeguard against undefined\n      _jsxDEV(\"div\", {\n        className: \"list-group-item border-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-shrink-0 me-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-light rounded-circle d-flex align-items-center justify-content-center\",\n              style: {\n                width: '40px',\n                height: '40px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-muted\",\n                children: \"U\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-grow-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mb-1\",\n              children: comment.comment_text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"text-muted\",\n              children: \"Posted just now\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 17\n        }, this)\n      }, comment.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n};\n_s(CommentsSection, \"Hd9854vo0imoVeianR3UmuNQj8c=\");\n_c = CommentsSection;\nexport default CommentsSection;\nvar _c;\n$RefreshReg$(_c, \"CommentsSection\");","map":{"version":3,"names":["React","CreateComment","getTimeDisplay","jsxDEV","_jsxDEV","CommentsSection","nodeId","_s","comments","setComments","useState","showCommentForm","setShowCommentForm","isLoading","setIsLoading","useEffect","fetchComments","commentRes","fetch","commentsData","json","error","console","refreshComments","newComment","prevComments","then","res","updatedComments","catch","prev","filter","c","id","className","children","role","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onCommentCreated","length","map","comment","style","width","height","comment_text","_c","$RefreshReg$"],"sources":["/Users/yc/Documents/MainWebsiteTree/Algorithm+TopicSutff/algorithm-app/src/components/NodePageComponents/CommentsSection.js"],"sourcesContent":["import React from 'react';\nimport CreateComment from './CreateComment';\nimport getTimeDisplay from '../../utils/helperFunctions/GetTimeSince';\n\nconst CommentsSection = ({ nodeId }) => {\n  const [comments, setComments] = React.useState([]);\n  const [showCommentForm, setShowCommentForm] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(true);\n\n  // Fetch comments\n  React.useEffect(() => {\n    const fetchComments = async () => {\n      setIsLoading(true);\n      try {\n        const commentRes = await fetch(`http://localhost:5000/api/nodes/${nodeId}/comments`);\n        const commentsData = await commentRes.json();\n        setComments(commentsData);\n      } catch (error) {\n        console.error('Error fetching comments:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchComments();\n  }, [nodeId]);\n\n  const refreshComments = (newComment) => {\n    if (!newComment) return; // Guard against undefined\n    \n    // Optimistically update UI\n    setComments(prevComments => [newComment, ...prevComments]);\n    setShowCommentForm(false);\n    \n    // Refetch to ensure data consistency\n    fetch(`http://localhost:5000/api/nodes/${nodeId}/comments`)\n      .then(res => res.json())\n      .then(updatedComments => setComments(updatedComments))\n      .catch(error => {\n        console.error('Refresh error:', error);\n        // Revert optimistic update on error\n        setComments(prev => prev.filter(c => c.id !== newComment.id));\n      });\n  };\n\n  if (isLoading) return (\n    <div className=\"d-flex justify-content-center my-5\">\n      <div className=\"spinner-border\" role=\"status\">\n        <span className=\"visually-hidden\">Loading...</span>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"card mb-4\">\n      <div className=\"card-header bg-light d-flex justify-content-between align-items-center py-3\">\n        <h2 className=\"h5 mb-0\">Attempts to solve</h2>\n        <button \n          className={`btn btn-sm ${showCommentForm ? 'btn-outline-secondary' : 'btn-primary'}`}\n          onClick={() => setShowCommentForm(!showCommentForm)}\n        >\n          {showCommentForm ? 'Cancel' : 'Add New'}\n        </button>\n      </div>\n      \n      {showCommentForm && (\n        <div className=\"card-body border-bottom\">\n          <CreateComment \n            onCommentCreated={refreshComments} \n          />\n        </div>\n      )}\n      \n      <div className=\"list-group list-group-flush\">\n        {comments.length === 0 ? (\n          <div className=\"text-center py-4\">\n            <p className=\"text-muted\">No comments yet</p>\n            <button \n              className=\"btn btn-link\"\n              onClick={() => setShowCommentForm(true)}\n            >\n              Be the first to add a comment\n            </button>\n          </div>\n        ) : (\n          comments.map(comment => (\n            comment && ( // Safeguard against undefined\n              <div key={comment.id} className=\"list-group-item border-0\">\n                <div className=\"d-flex\">\n                  <div className=\"flex-shrink-0 me-3\">\n                    <div \n                      className=\"bg-light rounded-circle d-flex align-items-center justify-content-center\" \n                      style={{width: '40px', height: '40px'}}\n                    >\n                      <span className=\"text-muted\">U</span>\n                    </div>\n                  </div>\n                  <div className=\"flex-grow-1\">\n                    <p className=\"mb-1\">{comment.comment_text}</p>\n                    <small className=\"text-muted\">Posted just now</small>\n                  </div>\n                </div>\n              </div>\n            )\n          ))\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CommentsSection;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}